:root{
  --bg:#0b0f14;
  --panel:#0f141b;
  --text:#ffffff;  /* Белый текст для контраста */
  --muted:#c9d6ff;
  --accent:#8a5cff;
  --accent2:#00e5ff;
  --danger:#ff4d6d;
  --ok:#00d48a;
  --radius:16px;
  --ring: 0 0 0 2px rgba(138,92,255,.35), 0 0 40px rgba(0,229,255,.15) inset;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
    radial-gradient(1200px 700px at 20% -10%, #141b2a 0%, #0b0f14 60%),
    #0b0f14;
  color:var(--text);
  font: 15px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial;
  overflow:hidden;
}

/* Звёздное поле + параллакс */
canvas.stars{position:fixed; inset:0; z-index:-1; filter:contrast(115%) saturate(120%)}

/* Верхняя панель */
.topbar{
  position:sticky; top:0; display:flex; align-items:center; gap:12px;
  padding:14px 18px; background:linear-gradient(180deg, rgba(17,23,31,.85), rgba(17,23,31,.35), transparent);
  backdrop-filter: blur(8px);
  border-bottom:1px solid rgba(255,255,255,.06);
  z-index:2;
}
.logo{display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.3px}
.logo-badge{
  width:28px; height:28px; border-radius:8px;
  background: conic-gradient(from 210deg, var(--accent), var(--accent2), var(--accent));
  box-shadow: 0 0 18px rgba(138,92,255,.65), 0 0 30px rgba(0,229,255,.35);
  animation: spin 8s linear infinite;
}
.glow{
  color:var(--text);
  background:linear-gradient(90deg, #fff, #c9eaff 40%, #edd6ff 70%, #fff);
  -webkit-background-clip:text; background-clip:text;
  text-shadow: 0 0 8px rgba(138,92,255,.45);
  animation: shimmer 6s linear infinite;
}
.top-actions{margin-left:auto; display:flex; align-items:center; gap:8px}
.icon-btn{
  background: rgba(255,255,255,.06); color:var(--text);
  border:1px solid rgba(255,255,255,.08);
  padding:8px 12px; border-radius:10px; outline:none; cursor:pointer;
  transition:.2s ease transform, .2s ease border-color, .2s ease box-shadow;
}
.icon-btn:hover{transform: translateY(-1px); border-color: rgba(255,255,255,.2); box-shadow: 0 6px 24px rgba(0,0,0,.25)}

/* Контентная сетка */
.wrap{
  height: calc(100% - 64px);
  display:grid; grid-template-rows: 1fr auto;
  padding: 12px; gap:12px;
}
.chat{
  overflow:auto; padding: 8px 8px 24px; scroll-behavior:smooth;
}

/* Пузырь сообщения */
.bubble{
  position:relative; max-width: 920px; margin:16px auto; padding:18px 20px;
  background: linear-gradient(180deg, rgba(18,24,36,.9), rgba(18,24,36,.7));
  border-radius: var(--radius);
  border:1px solid rgba(255,255,255,.08);
  box-shadow: 0 0 0 1px rgba(255,255,255,.02) inset, 0 10px 40px rgba(0,0,0,.25);
  animation: slideIn .35s ease both, float 6s ease-in-out infinite;
  will-change: transform, opacity;
}
.bubble.user{
  background: linear-gradient(180deg, rgba(22,28,42,.9), rgba(22,28,42,.75));
  border-image: linear-gradient(90deg, rgba(138,92,255,.35), rgba(0,229,255,.25)) 1;
}
.bubble.assistant{
  border-image: linear-gradient(90deg, rgba(0,229,255,.25), rgba(138,92,255,.4)) 1;
  box-shadow: var(--ring);
}
.row{display:flex; gap:12px}
.avatar{
  flex:0 0 36px; height:36px; border-radius:10px; margin-top:2px;
  background: radial-gradient(12px 12px at 30% 30%, #fff 0%, #ffd6ff 18%, transparent 20%),
              conic-gradient(from 210deg, var(--accent), var(--accent2), var(--accent));
  box-shadow: 0 0 12px rgba(138,92,255,.6), 0 0 16px rgba(0,229,255,.3);
  animation: pulse 2.5s ease-in-out infinite;
}
.body{flex:1}
.meta{opacity:.9; font-size:12px; margin-bottom:6px; color:var(--muted)}
.content{white-space:pre-wrap; word-wrap:break-word; color:var(--text)}

/* Markdown-стилизация */
.content h1,.content h2,.content h3{margin:10px 0 8px; line-height:1.2}
.content code{background:rgba(255,255,255,.1); padding:.2em .35em; border-radius:6px; border:1px solid rgba(255,255,255,.18)}
.codeblock{
  position:relative; background:#0d1117; border:1px solid #1f2937; border-radius:12px; padding:14px; margin:10px 0;
  overflow:auto; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:13px; color:#e6edf3;
}
.copy{
  position:absolute; top:8px; right:8px; padding:6px 10px; border-radius:8px; border:1px solid rgba(255,255,255,.18);
  background:rgba(255,255,255,.06); color:#cfe7ff; cursor:pointer; transition:.2s ease transform,.2s ease border-color;
}
.copy:hover{transform: translateY(-1px); border-color: rgba(255,255,255,.35)}

/* Композер */
.composer{display:flex; flex-direction:column; gap:10px; max-width: 980px; margin:0 auto 14px; width:100%}
.hints{display:flex; gap:8px; flex-wrap:wrap; opacity:.9}
.hint{
  padding:6px 10px; background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.18);
  border-radius:8px; cursor:pointer; transition:.15s ease; color:var(--text)
}
.hint:hover{transform: translateY(-1px) scale(1.02); border-color: rgba(255,255,255,.35)}
.bar{
  display:flex; gap:10px; align-items:flex-end; background:rgba(255,255,255,.07);
  border:1px solid rgba(255,255,255,.18); border-radius:16px; padding:10px; box-shadow: var(--ring);
}
textarea{
  flex:1; resize:none; max-height:220px; min-height:44px; border:0; outline:none; background:transparent; color:var(--text);
  font:inherit;
}
.buttons{display:flex; gap:8px; align-items:center}
.send{
  padding:10px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.25); background:linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.04));
  color:#e7ecff; cursor:pointer; transition:.25s ease; display:flex; align-items:center; gap:8px;
}
.send:hover{transform: translateY(-1px); border-color: rgba(255,255,255,.45); box-shadow: 0 12px 40px rgba(0,0,0,.35)}
.stop{
  padding:10px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.25); background:linear-gradient(180deg, rgba(255,77,109,.25), rgba(255,77,109,.08));
  color:#ffd7de; cursor:pointer;
}
.plane{
  width:16px; height:16px; display:inline-block; transform: translateX(0); transition: transform .25s ease;
  background: conic-gradient(from 160deg, var(--accent2), var(--accent));
  -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24" fill="white"><path d="M2 21l21-9L2 3v7l15 2-15 2v7z"/></svg>') center/contain no-repeat;
          mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24" fill="white"><path d="M2 21l21-9L2 3v7l15 2-15 2v7z"/></svg>') center/contain no-repeat;
}
.send:hover .plane{transform: translateX(4px)}

/* Индикатор набора */
.typing{display:inline-flex; gap:4px; align-items:center; margin-left:2px}
.dot{width:6px; height:6px; border-radius:50%; background:#bfe9ff; opacity:.8; animation: blink 1s infinite ease-in-out}
.dot:nth-child(2){animation-delay:.2s}
.dot:nth-child(3){animation-delay:.4s}

/* Анимации */
@keyframes blink{0%,80%,100%{opacity:.2; transform: translateY(0)}40%{opacity:1; transform: translateY(-2px)}}
@keyframes slideIn{from{opacity:0; transform: translateY(10px)} to{opacity:1; transform: translateY(0)}}
@keyframes spin{to{transform: rotate(360deg)}}
@keyframes shimmer{0%{filter: hue-rotate(0deg)}100%{filter: hue-rotate(360deg)}}
@keyframes pulse{0%,100%{transform: scale(1)}50%{transform: scale(1.05)}}
@keyframes float{0%,100%{transform: translateY(0)}50%{transform: translateY(-2px)}}

/* Доступность */
.sr{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border-width:0}

/* Адаптив */
@media (max-width: 640px){
  .wrap{padding:8px}
  .bubble{margin:12px auto; padding:14px 16px}
  .topbar{padding:10px 12px}
}